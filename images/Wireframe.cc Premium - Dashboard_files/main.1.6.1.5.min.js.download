function paginate(e){$(".pagination").jPages({containerID:"plist",animation:"none",delay:0,keyBrowse:!0,first:!1,previous:!1,next:!1,last:!1,midRange:15,links:"blank",perPage:10,callback:function(e){currpage=e.current}}),e&&e()}var currpage,orgname;function showlist(){$("#projectlist").css("opacity",1)}function resetSearch(e){$("#searchnames").val("").blur(),$("#nothingfound").hide(),$("#search-x").hide(),e&&($("#plist li").show(),$("#plist > li").length>10&&($("#plist>li").tsort({data:"date",order:"desc"}),paginate()))}$(".content").length>10?paginate(showlist):showlist(),"8"==$(".trialinfo b").text()&&$(".trialinfo b").text("7"),jQuery(document).ready(function(){jQuery.expr[":"].Contains=function(e,t,n){return jQuery(e).text().toUpperCase().indexOf(n[3].toUpperCase())>=0},$("#searchnames").bind("keyup",function(){var e=$("#searchnames").val();if(""!=e){$("#search-x").show(),$(".content").length>10&&$(".pagination").jPages("destroy"),$(".content .projectname:Contains('"+e+"')").parents("li").show(),$(".content .projectname:not(:Contains("+e+"))").parents("li").hide();var t=$(".content:visible");0==t.length?($("#nothingfound").show(),$(".content").length>10&&$(".pagination").jPages("destroy")):$("#nothingfound").hide(),t.length>10&&paginate()}else resetSearch()})}),$("#search-x").click(resetSearch),$(".newproject").click(function(){$("body").addClass("adding"),$(".welcomcard-wrap , h2").hide(),$(".welcomcard-wrap").length,$(".addtemp").show(),$(".addnewname").focus()}),$(".importproject").click(function(){$("body").addClass("show-import-modal"),$("#free-name").click()}),$(".cancelnew").click(function(){$("body").removeClass("adding"),$(".addtemp").hide(),$(".welcomcard-wrap , h2").show(),$(".newproject").show()}),$(".cancelimport").click(function(){$(".newproject , .importproject").removeClass("adding"),$(".welcomcard-wrap , h2").show(),$(".importwrap").hide()}),$("#projectlist ul").mouseover(function(){$(".newproject , .searchbox , .importproject").addClass("adddisabled")}),$("#projectlist ul").mouseout(function(){$(".newproject , .searchbox , .importproject").removeClass("adddisabled"),$(".newproject , .searchbox , .importproject").removeClass("adddisabled")}),$(document).on("click",".projectname",function(e){this.isContentEditable||($(".content").length,this.contentEditable="true",$(this).attr("spellcheck","false"),this.focus(),orgname=$(this).html(),$("#plist").addClass("edited"))}),$(document).on("keypress",".projectname",function(e){13==e.which&&(e.preventDefault(),this.blur())}),$(document).on("focus",".projectname",function(e){$("#plist").addClass("edited")}),$(document).on("blur",".projectname",function(e){$("#plist").removeClass("edited"),this.contentEditable="false",$(".content").length;var t=$(this).text();if("<br>"==t&&$(this).html("No name"),t===orgname)return!1;thisname=$(this);var n=$(this).attr("wireid");$.ajax({type:"post",url:"renamewire.php",data:{id:n,name:t},success:function(){thisname.addClass("changedname").delay(1e3).queue(function(e){$(this).removeClass("changedname"),e()})}})}),$(document).on("click",".delme",function(){if(!confirm("This wireframe will be deleted. Are you sure?"))return!1}),$(document).on("click",".deluser",function(e){if(!confirm("This user will be deleted. Are you sure?"))return!1}),$(document).on("click",".restore",function(e){if(!confirm("This version will replace the current one. Are you sure?"))return!1});var desc=!1;function getHistory(e){e.stopPropagation(),e.preventDefault;var t=$(this),n=t.parent(),r=(n.index(),Math.ceil(n.index()/10));$.get("history/"+$(this).attr("data-forkid"),function(e){t.addClass("clicked"),n.css("margin-bottom",0),$(".content").length>10&&$(".pagination").jPages("destroy"),t.parent().after(e),$(".content").length>10&&(paginate(),$(".pagination").jPages(r))})}function checkBodyHeight(){$("#import-gallery").hasScrollBar()?$("#import-gallery").addClass("has-scrollbar"):$("#import-gallery").removeClass("has-scrollbar")}$("#sortprojects").click(function(){$(".historyul").hide(),$(".clicked").removeClass("clicked"),$(".content").length>10&&$(".pagination").jPages("destroy"),desc?$("#plist>li").tsort(".projectname",{order:"desc"}):$("#plist>li").tsort(".projectname",{order:"asc"}),$(this).toggleClass("asc","desc"),desc=!desc,$(".content").length>10&&paginate()}),$(document).on("click","#lastmod",function(){$(".content").length>10&&$(".pagination").jPages("destroy"),$(".historyul").hide(),$(".clicked").removeClass("clicked"),desc?$("#plist>li").tsort({data:"date",order:"desc"}):$("#plist>li").tsort({data:"date",order:"asc"}),$(this).toggleClass("asc","desc"),desc=!desc,$(".content").length>10&&paginate()}),$(".author-label").click(function(){$(".historyul").hide(),$(".clicked").removeClass("clicked"),$(".content").length>10&&$(".pagination").jPages("destroy"),desc?$("#plist>li").tsort(".author",{order:"desc"}):$("#plist>li").tsort(".author",{order:"asc"}),$(this).toggleClass("asc","desc"),desc=!desc,$(".content").length>10&&paginate()}),$(document).on("click",".rev:not(.clicked)",getHistory),$(".uname").click(function(){$(".drop").show()}),$(".drop").mouseleave(function(){$(this).hide()}),$(document).on("click",".clicked",function(){$(".content").length>10&&$(".pagination").jPages("destroy"),$(this).removeClass("clicked").parent().next(".historyul").remove(),$(".content").length>10&&paginate()}),$("#import-overlay , #import-close , .cancel-import").on("click",function(){$("body").removeClass("show-import-modal adding"),$(".wcc-free-selected").removeClass("wcc-free-selected")}),$(".importform").on("click",function(){$(".importinput").focus()}),$("#import-gallery").on("mouseout",".w-thumb-wrap",function(){$(this).removeClass("wcc-selected-removed")}),$("#select-all-free").on("click",function(e){e.stopPropagation(),$(".w-thumb-wrap").addClass("wcc-free-selected")}),$("#import-btn").on("click",function(){$("#import-notification").removeClass("show"),$("#w-missing").empty();var e=[];$(".wcc-free-selected").each(function(t,n){e.push($(n).data("url"))}),""!==$("#free-name").val()&&e.push($("#free-name").val()),e.length?sendUrls(e):window.alert("Please select a wireframe or provide a url.")}),$.fn.hasScrollBar=function(){return this.get(0).scrollHeight>this.height()},$("#import-gallery").length&&(checkBodyHeight(),window.onresize=checkBodyHeight),null!==localStorage.getItem("wcc-saved")&&$("#import-card, #import-card-wrap").addClass("gallery"),null==localStorage.getItem("import-modal-shown")&&null!==localStorage.getItem("wcc-saved")&&(localStorage.setItem("import-modal-shown",1),$("body").addClass("show-import-modal"));const selection=Selection.create({class:"sel-area",selectables:[".w-thumb-wrap"],boundaries:["#import-gallery"],startThreshold:10}).on("beforestart",function({oe:e,area:t}){$(e.target).hasClass("w-thumb-wrap")||$(e.target).hasClass("sel-ignore")||$(".wcc-free-selected").removeClass("wcc-free-selected"),$(".importinput").blur()}).on("start",({inst:e,selected:t,oe:n,area:r})=>{}).on("move",({area:e,changed:{removed:t,added:n}})=>{for(const e of n)e.classList.contains("wcc-free-selected")?(e.classList.remove("wcc-free-selected"),e.classList.add("wcc-selected-removed"),e.classList.add("wcc-selected-removed")):e.classList.add("wcc-free-selected");for(const e of t)e.classList.remove("wcc-free-selected")}).on("stop",({inst:e,area:t,removed:n,added:r})=>{});if($("#import-gallery").length&&null!==localStorage.getItem("wcc-saved")&&"content"in document.createElement("template")){var grid=document.querySelector("#import-gallery-grid"),template=document.querySelector("#imported-item"),$obj=$(),saved=JSON.parse(localStorage.getItem("wcc-saved"));$.each(saved.order,function(e,t){if(!(e>100)){var n=template.content.cloneNode(!0);n.querySelector(".w-thumb-wrap").setAttribute("data-url",t),saved[t].img?n.querySelector("img").setAttribute("src",saved[t].img):n.querySelector(".w-thumb-wrap").classList.add("no-image"),n.querySelector(".wcc-free-name").textContent=t,n.querySelector(".wcc-free-date").textContent=timeSince(new Date(saved[t].date)),grid.appendChild(n)}})}function timeSince(e){var t=new Date,n=(t.getTime()-e.getTime())/1e3;return n<60?parseInt(n)+"s ago":n<3600?parseInt(n/60)+"m ago":n<=86400?parseInt(n/3600)+"h ago":n>86400?(day=e.getDate(),month=e.toDateString().match(/ [a-zA-Z]*/)[0].replace(" ",""),year=e.getFullYear()==t.getFullYear()?"":" "+e.getFullYear(),day+" "+month+year):void 0}function sendUrls(e){$.ajax({type:"post",url:"importwire.php",data:{ids:e},success:function(e){prependImportedProjects(JSON.parse(e)),$("body").removeClass("show-import-modal"),$(".welcomcard-wrap").hide(),$(".wcc-free-selected").removeClass("wcc-free-selected")}})}function prependImportedProjects(e){if(e.length&&"content"in document.createElement("template")){var t=document.querySelector("#plist"),n=document.querySelector("#li-project"),r=[];$.each(e,function(e,o){if(o.missing)r.push(o.missing);else{var a=n.content.cloneNode(!0);a.querySelector(".edit-btn").setAttribute("href","edit/"+o.id),a.querySelector(".prev-btn").setAttribute("href","pp/"+o.preview+o.id),a.querySelector(".dupli").setAttribute("href","duplicate/"+o.id),a.querySelector(".delme").setAttribute("href","delete/"+o.id),a.querySelector(".projectname").setAttribute("wireid",o.id),a.querySelector(".projectname").textContent=o.name,a.querySelector(".listicon").classList.add("fade-in"),t.insertBefore(a,t.firstChild)}}),$(".content").length>10&&$(".pagination").jPages("destroy"),paginate(),r.length&&($("#w-missing").append(r.join(", ")),$("#import-notification").addClass("show"))}}document.onkeydown=function(e){27==(e=e||window.event).keyCode&&($(".projectname[contenteditable=true]").length&&$(".projectname[contenteditable=true]").blur(),$("#searchnames").is(":focus")&&resetSearch(""!==$("#searchnames").val()),$("body").hasClass("show-import-modal")&&($("body").removeClass("show-import-modal"),$(".wcc-free-selected").removeClass("wcc-free-selected")),$("body").hasClass("adding")&&$("body").removeClass("adding"))},function(e,t){var n=!1,r=null,o=parseFloat,a=Math.min,s=/(-?\d+\.?\d*)$/g,i=/(\d+\.?\d*)$/g,c=[],l=[],d=function(e){return"string"==typeof e},h=Array.prototype.indexOf||function(e){var t=this.length,n=Number(arguments[1])||0;for((n=n<0?Math.ceil(n):Math.floor(n))<0&&(n+=t);n<t;n++)if(n in this&&this[n]===e)return n;return-1};function u(e){return e&&e.toLowerCase?e.toLowerCase():e}function p(e,t){for(var r=0,o=e.length;r<o;r++)if(e[r]==t)return!n;return n}e.tinysort={id:"TinySort",version:"1.5.2",copyright:"Copyright (c) 2008-2013 Ron Valstar",uri:"http://tinysort.sjeiti.com/",licensed:{MIT:"http://www.opensource.org/licenses/mit-license.php",GPL:"http://www.gnu.org/licenses/gpl.html"},plugin:function(e,t){c.push(e),l.push(t)},defaults:{order:"asc",attr:r,data:r,useVal:n,place:"start",returns:n,cases:n,forceStrings:n,ignoreDashes:n,sortFunction:r}},e.fn.extend({tinysort:function(){var t,m,g,$=this,f=[],w=[],y=[],v=[],b=0,C=[],k=[],S=function(t){e.each(c,function(e,n){n.call(n,t)})},x=function(t,r){var a=0;for(0!==b&&(b=0);0===a&&b<g;){var c=v[b],h=c.oSettings,p=h.ignoreDashes?i:s;if(S(h),h.sortFunction)a=h.sortFunction(t,r);else if("rand"==h.order)a=Math.random()<.5?1:-1;else{var m=n,$=h.cases?t.s[b]:u(t.s[b]),f=h.cases?r.s[b]:u(r.s[b]);if(!P.forceStrings){var w=d($)?$&&$.match(p):n,y=d(f)?f&&f.match(p):n;if(w&&y)$.substr(0,$.length-w[0].length)==f.substr(0,f.length-y[0].length)&&(m=!n,$=o(w[0]),f=o(y[0]))}a=c.iAsc*($<f?-1:$>f?1:0)}e.each(l,function(e,t){a=t.call(t,m,$,f,a)}),0===a&&b++}return a};for(t=0,m=arguments.length;t<m;t++){var q=arguments[t];d(q)?C.push(q)-1>k.length&&(k.length=C.length-1):k.push(q)>C.length&&(C.length=k.length)}for(C.length>k.length&&(k.length=C.length),0===(g=C.length)&&(g=C.length=1,k.push({})),t=0,m=g;t<m;t++){var A=C[t],P=e.extend({},e.tinysort.defaults,k[t]),F=!(!A||""==A),I=F&&":"==A[0];v.push({sFind:A,oSettings:P,bFind:F,bAttr:!(P.attr===r||""==P.attr),bData:P.data!==r,bFilter:I,$Filter:I?$.filter(A):$,fnSort:P.sortFunction,iAsc:"asc"==P.order?1:-1})}for(j in $.each(function(t,n){var r,o=e(n),a=o.parent().get(0),s=[];for(j=0;j<g;j++){var i=v[j],c=i.bFind?i.bFilter?i.$Filter.filter(n):o.find(i.sFind):o;s.push(i.bData?c.data(i.oSettings.data):i.bAttr?c.attr(i.oSettings.attr):i.oSettings.useVal?c.val():c.text()),void 0===r&&(r=c)}var l=h.call(y,a);l<0&&(l=y.push(a)-1,w[l]={s:[],n:[]}),r.length>0?w[l].s.push({s:s,e:o,n:t}):w[l].n.push({e:o,n:t})}),w)w[j].s.sort(x);for(j in w){var D=w[j],L=D.s.length,T=[],B=L,H=[0,0];switch(P.place){case"first":e.each(D.s,function(e,t){B=a(B,t.n)});break;case"org":e.each(D.s,function(e,t){T.push(t.n)});break;case"end":B=D.n.length;break;default:B=0}for(t=0;t<L;t++){var M=p(T,t)?!n:t>=B&&t<B+D.s.length,N=(M?D.s:D.n)[H[M?0:1]].e;N.parent().append(N),!M&&P.returns||f.push(N.get(0)),H[M?0:1]++}}return $.length=0,Array.prototype.push.apply($,f),$}}),e.fn.TinySort=e.fn.Tinysort=e.fn.tsort=e.fn.tinysort}(jQuery);